<!DOCTYPE html>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta charset="utf-8">
<meta name="author" content="Jane">
<meta name="description" content="STATISTICS, ALGORITHMS, DATA STRUCTURE, DATA ENGINEERING, MACHINE LEARNING, DEEP LEARNING, ETC.">
<title> [Hadoop] Hadoop 완전분산모드 설치 › Signal</title>
<link rel="canonical" href="http://localhost:4000/programming/2018/03/01/Hadoop_Setting/">
<link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,300italic,400italic" rel="stylesheet">
<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link href="/basic.css" rel="stylesheet">
<link href="/highlight.css" rel="stylesheet">
<link href="/index.css" rel="stylesheet">
<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Signal" />
<script src="//Signal.disqus.com/embed.js" async></script>

<header>
  <h1><a href="">Signal</a></h1>
  <nav>
    <div><a href="/">Home</a><a href="/archive/">Archive</a><a href="/about/">About</a></div>
    <div><a href="https://github.com/lovesignal"><i class="fa fa-github"></i></a><a href="mailto: hmtb.signal@gmail.com"><i class="fa fa-envelope"></i></a></div>
  </nav>
</header>
<main>
  <article>
    <header>
      <h1><a href="/programming/2018/03/01/Hadoop_Setting/">[Hadoop] Hadoop 완전분산모드 설치</a></h1>
      <time datetime="2018-03-01T00:00:00+09:00">March 1, 2018</time>
    </header>
<h2 id="progamming-hadoop-완전분산모드-설치">[Progamming] Hadoop 완전분산모드 설치</h2>

<p>VirtualBox 에 4개의 Ubuntu 를 만든다.</p>

<p>설치 시 사용자명은 hadoop 으로 한다.</p>

<p>4개를 따로 설치하거나 1개를 만들어서 3개를 복제한다.</p>

<p>각각 아래처럼 이름과 IP 주소를 사용할 예정. 
IP 주소는 각 VirtualBox에서 자동으로 생성되고 뒤에 2자리만 순서대로 변경해서 넣어주면된다.</p>

<p>192.168.30.101 hadoop01</p>

<p>192.168.30.102 hadoop02</p>

<p>192.168.30.103 hadoop03</p>

<p>192.168.30.104 hadoop04</p>

<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/hadoop_copy.png?raw=true" alt="" />
<br /></p>

<h4 id="복제-전에-할-일">복제 전에 할 일</h4>

<p>hadoop01에 아래와 같이 먼저 설치한 후 복제해서 hadoop02 ~ hadoop04를 만든다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// vim 설치
$ sudo apt-get install vim

// 각각 Ubuntu 에 JDK 8 설치
$ sudo add-apt-repository ppa:webupd8team/java
$ sudo apt-get update
$ sudo apt-get install oracle-java8-installer
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// 자바 환경설정. 아래 내용 입력 후 저장
$ vim .bashrc
export JAVA_HOME=/usr/lib/jvm/java-8-oracle
</code></pre></div></div>

<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/java_path.png?raw=true" alt="" />
<br />
<br /></p>

<h3 id="virtualbox-호스트-전용-어댑터-설정">VirtualBox 호스트 전용 어댑터 설정</h3>

<h4 id="1-전체-설정">1. 전체 설정</h4>

<p>VirtualBox &gt; 전역 도구(G) &gt; 호스트 네트워크 관리자 &gt; 만들기 &gt; vboxnet0 &gt; 192.168.57.1 &gt; 어댑터 &gt; o 수동으로 어댑터 설정 &gt; IPv4 주소: 192.168.30.1 &gt; IPv4 서브넷 마스크: 255.255.255.0</p>

<h4 id="2-각-vm이-종료된-상태에서-어댑터-추가">2. 각 VM이 종료된 상태에서 어댑터 추가</h4>

<p>VM &gt; 우클릭 &gt; 설정 &gt; 네트워크 &gt; 어댑터 2 &gt; v 네트워크 어댑터 사용하기 &gt; 다음에 연결됨: 호스트 전용 어댑터 &gt; 이름: vboxnet1 &gt; 확인</p>

<h4 id="hadoop-복제">hadoop 복제</h4>

<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/host1.png?raw=true" alt="" />
<img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/host2.png?raw=true" alt="" />
<img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/host3.png?raw=true" alt="" />
<img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/host4.png?raw=true" alt="" />
<img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/host6.png?raw=true" alt="" />
<img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/hadoop_copy.png?raw=true" alt="" /> 
<br /><br /></p>

<h4 id="3--게스트-os-네트워크-설정">3.  게스트 OS 네트워크 설정</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// ifconfig 로 체크한 이름 중 enp0s8 을 기준으로 수정하면 됨
$ ifconfig
</code></pre></div></div>

<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/ifconfig.png?raw=true" alt="" /> <br /><br /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// cat 으로 현재 정보 확인
$ sudo cat /etc/network/interfaces

// hadoop01 에서 vi 로 아래 내용 추가
$ sudo vi /etc/network/interfaces

auto enp0s8
iface enp0s8 inet static
address 192.168.56.101
netmask 255.255.255.0
network 192.168.56.1
</code></pre></div></div>

<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/interfaces.png?raw=true" alt="" /><br /><br /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// hostname 수정
$ sudo vi /etc/hostname
hadoop01
</code></pre></div></div>

<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/hostname.png?raw=true" alt="" /><br /><br /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo reboot
// 리부팅
</code></pre></div></div>

<h4 id="4-호스트-os-에서-ping-으로-체크하면-응답-ok">4. 호스트 OS 에서 ping 으로 체크하면 응답 OK</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ping 192.168.56.101

// hadoop02 에서 vi 로 아래 내용 추가
$ sudo vi /etc/network/interfaces

auto enp0s8
iface enp0s8 inet static
address 192.168.56.102
netmask 255.255.255.0
network 192.168.56.1

// hostname 수정
$ sudo vi /etc/hostname
hadoop02

// 리부팅
$ sudo reboot


// hadoop03 에서 vi 로 아래 내용 추가
$ sudo vi /etc/network/interfaces

auto enp0s8
iface enp0s8 inet static
address 192.168.56.103
netmask 255.255.255.0
network 192.168.56.1

// hostname 수정
$ sudo vi /etc/hostname
hadoop03

// 리부팅
$ sudo reboot


// hadoop04 에서 vi 로 아래 내용 추가
$ sudo vi /etc/network/interfaces

auto enp0s8
iface enp0s8 inet static
address 192.168.56.104
netmask 255.255.255.0
network 192.168.56.1

// hostname 수정
$ sudo vi /etc/hostname

hadoop04
// 리부팅


$ sudo vi /etc/hosts
127.0.0.1     localhost
192.168.56.101  hadoop01
192.168.56.102  hadoop02
192.168.56.103  hadoop03
192.168.56.104  hadoop04
</code></pre></div></div>

<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/hostsetting.png?raw=true" alt="" />
<br /><br /></p>

<p>hadoop02, hadoop03, hadoop04 에도 모두 같은 내용으로 hosts 파일 수정</p>

<p>hadoop01, hadoop02, hadoop03, hadoop04 모두 openssh-server 설치한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo apt-get install openssh-server
</code></pre></div></div>

<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/openssh_install.png?raw=true" alt="" />
<br /><br /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// 아래 부분은 hadoop01 에서만 실행
$ ssh-keygen -t rsa 

# 엔터 3번
$ cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys

$ ssh localhost 
# 처음 한번만 yes, 두번째 접속시 부터는 안 물어봄.

$ exit 
# exit 로 꼭 나와야 함

// hadoop02, hadoop03, hadoop04 에 키 복사
$ ssh-copy-id -i /home/hadoop/.ssh/id_rsa.pub hadoop@hadoop02
$ ssh-copy-id -i /home/hadoop/.ssh/id_rsa.pub hadoop@hadoop03
$ ssh-copy-id -i /home/hadoop/.ssh/id_rsa.pub hadoop@hadoop04

</code></pre></div></div>

<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/ssh_keys.png?raw=true" alt="" />
<br /><br /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// 접속 잘 되는지 확인
$ ssh hadoop@hadoop02

//hadoop 1.2.1 다운로드
$ wget https://archive.apache.org/dist/hadoop/common/hadoop-1.2.1/hadoop-1.2.1.tar.gz

// 압축 해제
$ tar zxvf hadoop-1.2.1.tar.gz

$ cd hadoop-1.2.1/
$ cd conf
$ vi hadoop-env.sh

// 맨아래에 내용 추가
export JAVA_HOME=/usr/lib/jvm/java-8-oracle
export HADOOP_HOME=/home/hadoop/hadoop-1.2.1
export HADOOP_HOME_WARN_SUPPRESS="TRUE"

export HADOOP_HEAPSIZE=1024     // 메모리 설정
export HADOOP_PID_DIR=/home/hadoop/hadoop-1.2.1/pids

</code></pre></div></div>

<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/path.png?raw=true" alt="" />
<br /><br /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
$ vi core-site.xml

&lt;?xml version="1.0"?&gt;
&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;

&lt;!-- Put site-specific property overrides in this file. --&gt;
&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;fs.default.name&lt;/name&gt;
        &lt;value&gt;hdfs://hadoop01:9000&lt;/value&gt;
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;
        &lt;value&gt;/home/hadoop/hadoop-data&lt;/value&gt;
    &lt;/property&gt;
&lt;/configuration&gt;

</code></pre></div></div>

<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/conf.png?raw=true" alt="" />
<br /><br /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ vi hdfs-site.xml

// dfs.replication : 복제갯수
 

&lt;?xml version="1.0"?&gt;
&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;

&lt;!-- Put site-specific property overrides in this file. --&gt;

&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;dfs.replication&lt;/name&gt;
        &lt;value&gt;3&lt;/value&gt;    
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;dfs.http.address&lt;/name&gt;
        &lt;value&gt;hadoop01:50070&lt;/value&gt;
    &lt;/property&gt;
    
    &lt;property&gt;
        &lt;name&gt;dfs.secondary.http.address&lt;/name&gt;
        &lt;value&gt;hadoop02:50090&lt;/value&gt;
    &lt;/property&gt;
&lt;/configuration&gt;
</code></pre></div></div>

<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/hdfs-site.png?raw=true" alt="" />
<br /><br /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// 맵리듀스 설정
$ vi mapred-site.xml

&lt;?xml version="1.0"?&gt;
&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;

&lt;!-- Put site-specific property overrides in this file. --&gt;

&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;mapred.job.tracker&lt;/name&gt;
        &lt;value&gt;hadoop01:9001&lt;/value&gt;
    &lt;/property&gt;
&lt;/configuration&gt;
</code></pre></div></div>

<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/mapred-site.png?raw=true" alt="" />
<br /><br /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cd hadoop-1.2.1/conf
$ ls
// secondary namenode: hadoop02
// slaves : datanode. hadoop02, hadoop03, hadoop04

$ vi masters 
hadoop02
</code></pre></div></div>
<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/masters.png?raw=true" alt="" /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ vi slaves
hadoop02
hadoop03
hadoop04
</code></pre></div></div>
<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/slaves.png?raw=true" alt="" />
<br /><br /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// 맨 상위로 이동
$ cd ~

// hadoop-1.2.1 통째로 압축
$ tar zcvf hadoop.tar.gz hadoop-1.2.1 

// hadoop02, hadoop03, hadoop04로 복사
$ scp hadoop.tar.gz hadoop@hadoop02:/home/hadoop
$ scp hadoop.tar.gz hadoop@hadoop03:/home/hadoop
$ scp hadoop.tar.gz hadoop@hadoop04:/home/hadoop

// 압축풀기
$ ssh hadoop@hadoop02
$ tar zxvf hadoop.tar.gz
$ exit

$ ssh hadoop@hadoop03
$ tar zxvf hadoop.tar.gz
$ exit
$ ssh hadoop@hadoop04
$ tar zxvf hadoop.tar.gz
$ exit

// 하둡 경로 설정 
$ vim .bashrc
export HADOOP_INSTALL=/home/hadoop/hadoop-1.2.1
exprot PATH=$PATH:$HADOOP_INSTALL/bin
</code></pre></div></div>

<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/path_setting.png?raw=true" alt="" />
<br /><br /></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ exit


// 리부트
$ sudo reboot
// hadoop 실행
$ hadoop

// 반드시 hadoop01 에서 실행
$ hadoop namenode -format
$ start-all.sh

$ jps
JobTracker
Jps
NameNode 
// 3가지 떠있는 것 확인 가능
// 나머지 hadoop2,3,4에서도 동일 명령어로 확인 가능

// hadoop01, hadoop02, hadoop03, hadoop04 에서 jps 실행해서 확인
// hadoop01은 NameNode, JobTracker
// hadoop02은 SecondaryNameNode, DataNode, TaskTracker
// hadoop03은 DataNode, TaskTracker
// hadoop04은 DataNode, TaskTracker 가 보이면 OK

// 반드시 종료 시켜야 함
$ stop-all.sh 
</code></pre></div></div>

<p>브라우저로 http://hadoop01:50070 으로 접속해서 HDFS 확인</p>

<p>브라우저로  http://hadoop01:50030 으로 접속해서 MapReduce 확인</p>

<p><img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/check1.png?raw=true" alt="" />
<br /><br />
<img src="https://github.com/lovesignal/lovesignal.github.io/blob/master/img/post/Programming/Hadoop/check2.png?raw=true" alt="" /></p>


    
    
    <hr><div id="disqus_thread"></div>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
  </article>
</main>


<footer>
     <span></span> 
    <a href="/algorithms/2018/03/01/BFS/">[Algorithms] BFS(Breadth-First Search 너비우선탐색) »</a>
</footer>

